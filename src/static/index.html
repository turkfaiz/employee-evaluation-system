<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تقييم الموظفين</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- شريط التنقل -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>
                نظام تقييم الموظفين
            </a>
            <div class="navbar-nav">
                <a class="nav-link" href="#" onclick="showPage('input-page')">
                    <i class="fas fa-user-plus me-1"></i>
                    إدخال البيانات
                </a>
                <a class="nav-link" href="#" onclick="showPage('view-page')">
                    <i class="fas fa-chart-bar me-1"></i>
                    عرض التقييمات
                </a>
                <a class="nav-link" href="#" onclick="showPage('overview-page')">
                    <i class="fas fa-users me-1"></i>
                    استعراض الموظفين
                </a>
                <a class="nav-link" href="#" onclick="showPage('departments-page')">
                    <i class="fas fa-building me-1"></i>
                    إدارة الأقسام
                </a>
            </div>
        </div>
    </nav>

    <!-- صفحة إدخال البيانات -->
    <div id="input-page" class="page-content">
        <div class="container mt-4">
            <div class="row">
                <div class="col-md-6">
                    <!-- إضافة موظف جديد -->
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-user-plus me-2"></i>
                                إضافة موظف جديد
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="employee-form">
                                <div class="mb-3">
                                    <label for="employee-number" class="form-label">الرقم الوظيفي</label>
                                    <input type="text" class="form-control" id="employee-number" required>
                                </div>
                                <div class="mb-3">
                                    <label for="full-name" class="form-label">الاسم الكامل</label>
                                    <input type="text" class="form-control" id="full-name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="job-title" class="form-label">المسمى الوظيفي</label>
                                    <input type="text" class="form-control" id="job-title" required>
                                </div>
                                <div class="mb-3">
                                    <label for="department" class="form-label">الإدارة</label>
                                    <select class="form-select" id="department" required>
                                        <option value="">اختر الإدارة</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save me-1"></i>
                                    إضافة الموظف
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <!-- إضافة تقييم شهري -->
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-star me-2"></i>
                                إضافة تقييم شهري
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="evaluation-form">
                                <div class="mb-3">
                                    <label for="eval-employee" class="form-label">الموظف</label>
                                    <select class="form-select" id="eval-employee" required>
                                        <option value="">اختر الموظف</option>
                                    </select>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="eval-month" class="form-label">الشهر</label>
                                            <select class="form-select" id="eval-month" required>
                                                <option value="">اختر الشهر</option>
                                                <option value="1">يناير</option>
                                                <option value="2">فبراير</option>
                                                <option value="3">مارس</option>
                                                <option value="4">أبريل</option>
                                                <option value="5">مايو</option>
                                                <option value="6">يونيو</option>
                                                <option value="7">يوليو</option>
                                                <option value="8">أغسطس</option>
                                                <option value="9">سبتمبر</option>
                                                <option value="10">أكتوبر</option>
                                                <option value="11">نوفمبر</option>
                                                <option value="12">ديسمبر</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="eval-year" class="form-label">السنة</label>
                                            <select class="form-select" id="eval-year" required>
                                                <option value="">اختر السنة</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div id="criteria-scores" class="mb-3">
                                    <!-- معايير التقييم ستظهر هنا -->
                                </div>
                                <button type="submit" class="btn btn-info">
                                    <i class="fas fa-save me-1"></i>
                                    حفظ التقييم
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- قائمة الموظفين -->
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-users me-2"></i>
                        قائمة الموظفين
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>الرقم الوظيفي</th>
                                    <th>الاسم الكامل</th>
                                    <th>المسمى الوظيفي</th>
                                    <th>الإدارة</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="employees-table">
                                <!-- بيانات الموظفين ستظهر هنا -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة عرض التقييمات -->
    <div id="view-page" class="page-content" style="display: none;">
        <div class="container mt-4">
            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0">
                                <i class="fas fa-search me-2"></i>
                                اختيار الموظف
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="view-employee" class="form-label">الموظف</label>
                                <select class="form-select" id="view-employee">
                                    <option value="">اختر الموظف</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="view-year" class="form-label">السنة</label>
                                <select class="form-select" id="view-year">
                                    <option value="">اختر السنة</option>
                                </select>
                            </div>
                            <button class="btn btn-warning" onclick="loadEmployeeData()">
                                <i class="fas fa-chart-line me-1"></i>
                                عرض التقييمات
                            </button>
                            
                            <!-- أزرار التصدير والمشاركة -->
                            <div class="mt-3">
                                <button class="btn btn-success btn-sm" onclick="exportAllEvaluations()">
                                    <i class="fas fa-file-excel me-1"></i>
                                    تصدير جميع التقييمات
                                </button>
                                <button class="btn btn-outline-success btn-sm mt-2" onclick="exportEmployeeEvaluations()" id="export-employee-btn" style="display: none;">
                                    <i class="fas fa-download me-1"></i>
                                    تصدير تقييم الموظف
                                </button>
                                
                                <!-- أزرار المشاركة -->
                                <hr>
                                <h6 class="text-muted">روابط المشاركة</h6>
                                <button class="btn btn-info btn-sm" onclick="createEmployeeShareLink()" id="share-employee-btn" style="display: none;">
                                    <i class="fas fa-share-alt me-1"></i>
                                    مشاركة تقييم الموظف
                                </button>
                                <button class="btn btn-outline-info btn-sm mt-2" onclick="createPublicShareLink()">
                                    <i class="fas fa-globe me-1"></i>
                                    مشاركة جميع الموظفين
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- معلومات الموظف -->
                    <div id="employee-info" class="card mt-3" style="display: none;">
                        <div class="card-header bg-info text-white">
                            <h6 class="mb-0">معلومات الموظف</h6>
                        </div>
                        <div class="card-body">
                            <div id="employee-details"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-8">
                    <!-- الرسوم البيانية -->
                    <div id="charts-container" style="display: none;">
                        <div class="card mb-4">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-line me-2"></i>
                                    متوسط التقييمات الشهرية
                                </h5>
                            </div>
                            <div class="card-body">
                                <canvas id="averageChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-bar me-2"></i>
                                    تقييمات المعايير
                                </h5>
                            </div>
                            <div class="card-body">
                                <canvas id="criteriaChart" width="400" height="300"></canvas>
                            </div>
                        </div>
                        
                        <!-- جدول التفاصيل -->
                        <div class="card">
                            <div class="card-header bg-secondary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-table me-2"></i>
                                    تفاصيل التقييمات
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr id="details-table-header">
                                                <th>الشهر</th>
                                            </tr>
                                        </thead>
                                        <tbody id="details-table-body">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة استعراض جميع الموظفين -->
    <div id="overview-page" class="page-content" style="display: none;">
        <div class="container mt-4">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-users me-2"></i>
                                استعراض جميع الموظفين
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- فلاتر البحث -->
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <label for="filter-department" class="form-label">فلترة حسب الإدارة</label>
                                    <select class="form-select" id="filter-department">
                                        <option value="">جميع الإدارات</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filter-year" class="form-label">السنة</label>
                                    <select class="form-select" id="filter-year">
                                        <option value="">اختر السنة</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="search-employee" class="form-label">البحث عن موظف</label>
                                    <input type="text" class="form-control" id="search-employee" placeholder="اسم الموظف أو الرقم الوظيفي">
                                </div>
                            </div>
                            
                            <!-- زر تحديث البيانات -->
                            <div class="mb-3">
                                <button class="btn btn-primary" onclick="loadEmployeesOverview()">
                                    <i class="fas fa-sync-alt me-1"></i>
                                    تحديث البيانات
                                </button>
                            </div>
                            
                            <!-- بطاقات الموظفين -->
                            <div id="employees-cards" class="row">
                                <!-- بطاقات الموظفين ستظهر هنا -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة إدارة الأقسام -->
    <div id="departments-page" class="page-content" style="display: none;">
        <div class="container mt-4">
            <div class="row">
                <!-- إضافة قسم جديد -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-plus me-2"></i>
                                إضافة قسم جديد
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="department-form">
                                <div class="mb-3">
                                    <label for="dept-name" class="form-label">اسم القسم</label>
                                    <input type="text" class="form-control" id="dept-name" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">معايير التقييم</label>
                                    <div id="criteria-list">
                                        <div class="criteria-item mb-2">
                                            <div class="input-group">
                                                <input type="text" class="form-control" placeholder="اسم المعيار" required>
                                                <button type="button" class="btn btn-outline-danger" onclick="removeCriteria(this)">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="addCriteria()">
                                        <i class="fas fa-plus me-1"></i>
                                        إضافة معيار
                                    </button>
                                </div>
                                
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save me-1"></i>
                                    حفظ القسم
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="resetDepartmentForm()">
                                    <i class="fas fa-undo me-1"></i>
                                    إلغاء
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- قائمة الأقسام الموجودة -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-list me-2"></i>
                                الأقسام الموجودة
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="departments-list">
                                <!-- قائمة الأقسام ستظهر هنا -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- رسائل التنبيه -->
    <div id="alert-container" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>